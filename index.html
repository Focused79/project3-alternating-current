<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Electric Vehicles Charging Points</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <!-- Leaflet JavaScript code -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <!-- Our CSS -->
    <link rel="stylesheet" href="./static/css/style.css" />
    
    <!-- D3 library -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Leaflet heatmap plugin-->
    <script type="text/javascript" src="static/js/leaflet-heat.js"></script>

</head>

<body>

    <div id="map" style="height: 650px;"></div>

    <!-- Dropdown for selecting state -->
    <label for="state-select">Select State:</label>
    <select id="state-select">
        <option value="marker.js">Home</option>
        <option value="markerCA.js" data-zoom="6" data-coordinates="[37.7783, -119.4179]">California</option>
        <option value="markerNC.js" data-zoom="7" data-coordinates="[35.7596, -79.0193]">North Carolina</option>
        <option value="markerTN.js" data-zoom="7" data-coordinates="[35.5175, -86.5804]">Tennessee</option>
        <option value="markerVT.js" data-zoom="7" data-coordinates="[44.5588, -72.5778]">Vermont</option>
    </select>

    <!-- Dropdown for selecting year -->
    <label for="year-select">Select Year:</label>
    <select id="year-select">
        <option value="2019">Befrore 2020</option>
        <option value="2020">2020</option>
        <option value="2021">2021</option>
        <option value="2022">2022</option>
    </select>

    <!-- JavaScript file -->
    <script type="text/javascript" src="static/js/marker.js" id="marker-script"></script>

    <script>
        // Function to load marker file based on selected state
        document.getElementById('state-select').addEventListener('change', function () {
            var selectedState = this.value;
            loadMarkerFile(selectedState);
        });

        // Function to load marker file based on selected state
        function loadMarkerFile(markerFile) {
            console.log("Selected state:", markerFile);

            // If "Home" is selected, reload the page
            if (markerFile === "marker.js") {
                location.reload();
                return; // Stop execution
            }

            // Remove previously loaded marker script
            var existingMarkerScript = document.getElementById('marker-script');
            if (existingMarkerScript) {
                existingMarkerScript.remove();
            }

            // Create new script element for selected marker file
            var newMarkerScript = document.createElement('script');
            newMarkerScript.id = 'marker-script';
            newMarkerScript.src = 'static/js/' + markerFile;
            newMarkerScript.type = 'text/javascript';
            document.body.appendChild(newMarkerScript);

            // Zoom to the selected state
            var selectElement = document.getElementById('state-select');
            var selectedIndex = selectElement.selectedIndex;
            var selectedOption = selectElement.options[selectedIndex];
            var zoom = selectedOption.dataset.zoom;
            var coordinates = JSON.parse(selectedOption.dataset.coordinates);

            // Zoom to the selected coordinates with the specified zoom level
            myMap.setView(coordinates, zoom);
        }
    </script>

</body>

<title>Total Stations by Year and State</title>

<body>
    <h1>Total Stations by Year and State</h1>
    <table>
      <tr>
        <th>State</th>
        <th>Stations before 2020</th>
        <th>Stations in 2020</th>
        <th>Stations in 2021</th>
        <th>Stations in 2022</th>
      </tr>
      <tr>
        <td>California</td>
        <td id="caStationsBefore2020"></td>
        <td id="caStations2020"></td>
        <td id="caStations2021"></td>
        <td id="caStations2022"></td>
      </tr>
      <tr>
        <td>North Carolina</td>
        <td id="ncStationsBefore2020"></td>
        <td id="ncStations2020"></td>
        <td id="ncStations2021"></td>
        <td id="ncStations2022"></td>
      </tr>
      <tr>
        <td>Tennessee</td>
        <td id="tnStationsBefore2020"></td>
        <td id="tnStations2020"></td>
        <td id="tnStations2021"></td>
        <td id="tnStations2022"></td>
      </tr>
      <tr>
        <td>Vermont</td>
        <td id="vtStationsBefore2020"></td>
        <td id="vtStations2020"></td>
        <td id="vtStations2021"></td>
        <td id="vtStations2022"></td>
      </tr>
    </table>
  
    <script>
      // URL for API request
    
  
      // Function to count stations before a specific year and for a specific state
      function countStationsBeforeYear(data, year, state) {
        let totalStations = 0;
  
        data.fuel_stations.forEach(station => {
          const stationYear = new Date(station.open_date).getFullYear();
          if (stationYear <= year && station.state === state) {
            totalStations++;
          }
        });
  
        return totalStations;
      }
  
      // Function to update HTML with station counts for a specific state
      function updateStationCounts(data, state) {
        const stationsBefore2020 = countStationsBeforeYear(data, 2020, state);
        const stations2020 = countStationsBeforeYear(data, 2021, state) - stationsBefore2020;;
        const stations2021 = countStationsBeforeYear(data, 2022, state) - stations2020 - stationsBefore2020;;
        const stations2022 = data.fuel_stations.filter(station => station.state === state).length - stationsBefore2020 - stations2020 - stations2021; ;
  
        document.getElementById(`${state.toLowerCase()}StationsBefore2020`).textContent = stationsBefore2020;
        document.getElementById(`${state.toLowerCase()}Stations2020`).textContent = stationsBefore2020 + stations2020;
        document.getElementById(`${state.toLowerCase()}Stations2021`).textContent = stationsBefore2020 + stations2020 + stations2021;
        document.getElementById(`${state.toLowerCase()}Stations2022`).textContent = stationsBefore2020 + stations2020 + stations2021 + stations2022;
      }
  
      // Fetch data from the API and update HTML for all states
      async function fetchDataAndUpdate() {
        try {
          const response = await fetch(url);
          const data = await response.json();
  
          // Check if data is available
          if (data && data.fuel_stations) {
            // Update counts for each state
            updateStationCounts(data, "CA"); // California
            updateStationCounts(data, "NC"); // North Carolina
            updateStationCounts(data, "TN"); // Tennessee
            updateStationCounts(data, "VT"); // Vermont
          } else {
            console.log("No data available");
          }
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }
  
      // Call the function to fetch data and update HTML for all states
      fetchDataAndUpdate();
    </script>
  </body>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiple Line Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multiple Line Charts</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Multiple Line Charts</h1>

  <!-- Dropdown menu -->
  <label for="chartSelector">Select State:</label>
  <select id="chartSelector">
    <option value="californiaChart">California</option>
    <option value="northCarolinaChart">North Carolina</option>
    <option value="tennesseeChart">Tennessee</option>
    <option value="vermontChart">Vermont</option>
  </select>

  <div>
    <h2>California</h2>
    <canvas id="californiaChart" width="400" height="200"></canvas>
  </div>

  <div>
    <h2>North Carolina</h2>
    <canvas id="northCarolinaChart" width="400" height="200"></canvas>
  </div>

  <div>
    <h2>Tennessee</h2>
    <canvas id="tennesseeChart" width="400" height="200"></canvas>
  </div>

  <div>
    <h2>Vermont</h2>
    <canvas id="vermontChart" width="400" height="200"></canvas>
  </div>

  <script>
    // Function to hide all charts
    function hideAllCharts() {
      const charts = document.querySelectorAll('canvas');
      charts.forEach(chart => {
        chart.style.display = 'none';
      });
    }

    // Function to show selected chart
    function showSelectedChart(chartId) {
      hideAllCharts();
      const selectedChart = document.getElementById(chartId);
      if (selectedChart) {
        selectedChart.style.display = 'block';
      }
    }

    // Event listener for dropdown change
    document.getElementById('chartSelector').addEventListener('change', function() {
      const selectedChartId = this.value;
      showSelectedChart(selectedChartId);
    });

    // Show default chart
    showSelectedChart('californiaChart');
  </script>
  <script src="graphCA.js"></script>
  <script src="graphNC.js"></script>
  <script src="graphTN.js"></script>
  <script src="graphVT.js"></script>
</body>
</html>
